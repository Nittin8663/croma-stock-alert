import requests
from bs4 import BeautifulSoup

def check_product_stock(url, product_name):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
    }
    
    try:
        response = requests.get(url, headers=headers, timeout=10)
        response.raise_for_status()
        
        soup = BeautifulSoup(response.text, 'html.parser')
        
        # Check for out of stock indicators
        out_of_stock_indicators = [
            'Out of Stock',
            'Sold Out',
            'Currently unavailable',
            'Coming Soon'
        ]
        
        stock_elements = soup.select('.pdp-product-availability, .product-availability, .stock-info')
        
        for element in stock_elements:
            element_text = element.get_text().strip()
            for indicator in out_of_stock_indicators:
                if indicator.lower() in element_text.lower():
                    print(f"❌ {product_name} is OUT OF STOCK")
                    return False
        
        # Check for buy buttons
        buy_buttons = soup.select('button.pdp-action, .buy-button, .add-to-cart')
        for button in buy_buttons:
            if button.get('disabled') is None:
                print(f"✅ {product_name} is IN STOCK!")
                return True
                
        # Check for Add to Cart button
        add_to_cart = soup.select('button[data-testid="add-to-cart"], button.add-to-cart')
        if add_to_cart and not add_to_cart[0].get('disabled'):
            print(f"✅ {product_name} is IN STOCK!")
            return True
            
        print(f"❓ Could not determine stock status for {product_name}, likely OUT OF STOCK")
        return False
        
    except Exception as e:
        print(f"Error checking {product_name}: {str(e)}")
        return False

# Check both phones
print("Checking Vivo phones stock status...\n")
check_product_stock("https://www.croma.com/vivo-x200-fe-5g-12gb-ram-256gb-frost-blue-/p/316890", "Vivo X200 FE 5G")
check_product_stock("https://www.croma.com/vivo-y300-5g-8gb-ram-128gb-rom-emerald-green-/p/311901", "Vivo Y300 5G")
